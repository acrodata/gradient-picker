<div class="gradient-stops-slider" [class.is-dragging]="isDragging" (pointerdown)="addStop($event)">
  <div class="gradient-stops-slider-bar">
    <div class="gradient-stops-slider-bar-bg" [style.background-image]="gradientColor"></div>
  </div>

  <div #sliderTrack class="gradient-stops-slider-track">
    @for (stop of _colorStops; track $index) {
      <div
        class="gradient-stops-slider-pointer"
        cdkDrag
        cdkDragLockAxis="x"
        [cdkDragBoundary]="sliderTrack"
        [cdkDragFreeDragPosition]="stop.position"
        (cdkDragMoved)="onDragMove($event, stop, $index)"
        (cdkDragEnded)="onDragEnd($event, stop)"
      >
        <div
          class="gradient-stops-slider-thumb"
          [class.gradient-stops-slider-thumb-active]="stop === selectedStop"
          (pointerdown)="onDragHandleDown($event, stop)"
          (pointerup)="onDragHandleUp($event)"
        >
          <gradient-colorpicker-toggle [for]="gc" [color]="stop.color" triggerEvent="dblclick" />
          <gradient-colorpicker
            #gc
            [(ngModel)]="stop.color"
            (ngModelChange)="onStopColorChange(stop)"
          />
        </div>
      </div>
    }
  </div>
</div>

<div class="gradient-stop-list-wrapper">
  <ul class="gradient-stop-list">
    @for (stop of _colorStops; track $index) {
      <li
        class="gradient-stop-item"
        [class.gradient-stop-item-active]="stop === selectedStop"
        (pointerdown)="onStopItemClick(stop)"
      >
        <gradient-input-field class="gradient-stop-item-color">
          <gradient-colorpicker-toggle [for]="gc" [color]="stop.color" />
          <gradient-colorpicker
            #gc
            [(ngModel)]="stop.color"
            (ngModelChange)="onStopColorChange(stop)"
          />
          <input type="text" [(ngModel)]="stop.color" (change)="onStopColorChange(stop)" />
        </gradient-input-field>
        <gradient-input-field class="gradient-stop-item-offset">
          <input
            type="number"
            min="0"
            max="100"
            [(ngModel)]="stop.offset.value"
            (change)="onStopOffsetChange(stop)"
          />
          <span>%</span>
        </gradient-input-field>
        <div class="gradient-stop-item-button">
          @if (_colorStops.length > 1) {
            <button type="button" (click)="onStopRemove(stop)">x</button>
          }
        </div>
      </li>
    }
  </ul>
</div>
